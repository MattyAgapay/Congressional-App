/* ========= COLOR PALETTE ========= */
:root{
  --mocha:#483D3F;   /* panel brown */
  --ocean:#456492;   /* ocean blue */
  --paper:#FAF7EF;   /* background */
  --mist:#A3A9A2;    /* border gray */
  --lava:#675A51;    /* warm dark */

  --ink:#2b2b2b;

  --ok:#2ecc71;
  --warn:#f1c40f;
  --bad:#e74c3c;

  --radius:16px;
  --shadow:0 6px 18px rgba(0,0,0,.15);

  --app-vh:1vh; /* iOS safe height */
}

/* ========= GLOBAL ========= */
*{box-sizing:border-box;}

html,body{
  margin:0;
  padding:0;
  font-family:'Inter',system-ui,sans-serif;
  background:var(--paper);
  color:var(--ink);
  height:100%;
  -webkit-font-smoothing:antialiased;
}

.app{
  display:grid;
  grid-template-rows:auto 1fr;
  min-height:100vh;
}

/* ========= HEADER ========= */
.app-header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px 16px;
  border-bottom:2px solid var(--mist);
  background:linear-gradient(180deg,rgba(69,106,146,.08),transparent);
  z-index:700;
  position:relative;
}

.brand{
  font-weight:800;
  font-size:18px;
  letter-spacing:.4px;
}
.subtitle{
  font-size:13px;
  opacity:.75;
}
.tag{
  margin-left:auto;
  background:var(--ocean);
  color:#fff;
  padding:7px 12px;
  border:none;
  border-radius:10px;
  font-size:12px;
  cursor:pointer;
}

/* ========= SCREENS ========= */
.screen{display:none;}
.screen.active{display:grid;}

/* ========= LANDING ========= */
#landing{
  display:grid;
  place-items:center;
  padding:40px;
}
.landing-card{
  width:min(900px,92vw);
  background:#fff;
  border:2px solid var(--mist);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:24px;
  display:grid;
  grid-template-columns:1fr auto;
  gap:22px;
}
.landing-card h1{margin:0;font-size:32px;}
.landing-card p{font-size:15px;opacity:.9;}
.landing-actions{
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* ========= BUTTONS ========= */
.btn{
  appearance:none;
  border:none;
  border-radius:12px;
  padding:12px 16px;
  font-weight:700;
  cursor:pointer;
  box-shadow:var(--shadow);
  min-height:44px; /* finger tap safe */
  transition:.15s;
}
.btn:active{transform:translateY(1px);}
.btn.primary{
  background:var(--ocean);
  color:#fff;
}
.btn.ghost{
  background:#fff;
  border:2px solid var(--mist);
}
.btn.ghost:hover{
  background:#f5f2ea;
}

/* ========= MAP LAYOUT ========= */
#map-screen{
  grid-template-columns:220px 1fr 360px;
  gap:12px;
  padding:12px;
}

/* ========= SIDEBAR NAV ========= */
.rail{
  background:var(--mocha);
  color:#fff;
  border-radius:18px;
  padding:10px;
  width:64px;
  display:flex;
  flex-direction:column;
  gap:8px;
  overflow:hidden;
  transition:width .18s ease;
  position:relative;
  z-index:800;
}
.rail:hover{width:220px;}

.rail-group{display:flex;flex-direction:column;gap:8px;}

.rail-btn{
  display:flex;
  align-items:center;
  gap:10px;
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.18);
  padding:11px 12px;
  border-radius:12px;
  color:#fff;
  cursor:pointer;
}
.rail-btn:hover{background:rgba(255,255,255,.13);}
.icon{
  font-size:18px;
  width:22px;
  text-align:center;
}
.label{
  white-space:nowrap;
  opacity:0;
  width:0;
  overflow:hidden;
  transition:opacity .15s,width .15s;
}
.rail:hover .label{
  opacity:1;
  width:auto;
}
.rail-sep{
  height:1px;
  background:rgba(255,255,255,.25);
  margin-top:auto;
}

/* tooltips collapsed */
.rail[data-collapsed="1"] .rail-btn{position:relative;}
.rail[data-collapsed="1"] .rail-btn:hover::after{
  content:attr(data-tip);
  position:absolute;
  left:60px;
  top:50%;
  transform:translateY(-50%);
  background:#000;
  color:#fff;
  padding:4px 8px;
  border-radius:6px;
  font-size:12px;
}

/* ========= MAP ========= */
#map{
  width:100%;
  height:calc((100 * var(--app-vh)) - 130px);
  border-radius:18px;
  border:2px solid var(--mist);
  box-shadow:var(--shadow);
  touch-action: pan-x pan-y;
}

/* ========= RIGHT PANEL ========= */
.panel{
  background:#fff;
  border:2px solid var(--mist);
  border-radius:18px;
  box-shadow:var(--shadow);
  padding:12px;
  display:flex;
  flex-direction:column;
  height:calc((100 * var(--app-vh)) - 130px);
}

.panel h3{
  margin:4px 6px 10px;
  font-size:16px;
  font-weight:800;
}

/* stats */
.stats{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.stat{
  background:#faf7f1;
  border:1px solid var(--mist);
  border-radius:14px;
  padding:10px;
}
.label{font-weight:700;font-size:13px;}

.bar{
  background:#e6e2d9;
  height:9px;
  border-radius:999px;
  overflow:hidden;
}
.bar>i{
  display:block;
  height:100%;
  background:linear-gradient(90deg,var(--bad),var(--warn),var(--ok));
}
.value{font-size:12px;margin-top:3px;}

/* decisions */
.decisions{
  margin-top:12px;
  display:grid;
  gap:10px;
}
.card{
  background:#fff;
  border:1px solid var(--mist);
  border-radius:12px;
  padding:10px;
}
.card .title{font-weight:700;margin-bottom:4px;}
.card .body{font-size:13px;opacity:.9;}
.card .actions{display:flex;gap:8px;margin-top:8px;}

.panel-footer{
  margin-top:auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

/* ========= DRAWER ========= */
.drawer{
  position:fixed;
  top:0;
  right:-420px;
  width:380px;
  height:100vh;
  background:#fff;
  border-left:2px solid var(--mist);
  padding:14px;
  box-shadow:var(--shadow);
  transition:right .25s ease;
  overflow:auto;
  z-index:900;
  pointer-events:none;
}
.drawer.open{
  right:0;
  pointer-events:auto;
}
.drawer-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.dex-list .card{margin-bottom:10px;}

/* encyclopedia hero card */
.dex-explore{
  background:var(--lava);
  color:#fff;
  border-radius:16px;
  display:grid;
  grid-template-columns:1fr 140px;
  overflow:hidden;
  min-height:160px;
  margin-bottom:12px;
}
.dex-explore .big{
  display:grid;
  place-items:center;
  background:var(--ocean);
  clip-path:circle(85% at 50% 50%);
}
.dex-explore .big::after{
  content:"";
  width:120px;
  height:120px;
  border-radius:50%;
  background:rgba(255,255,255,.15);
}
.dex-explore .meta{
  display:grid;
  align-content:end;
  padding:14px;
}

/* ========= MODAL ========= */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  place-items:center;
  padding:20px;
  z-index:1000;
  pointer-events:none;
}
.modal.open{
  display:grid;
  pointer-events:auto;
}
.modal .card{
  width:min(820px,92vw);
  background:#fff;
  border-radius:var(--radius);
  padding:20px;
  border:2px solid var(--mist);
  box-shadow:var(--shadow);
}

/* ========= TOAST ========= */
.toast{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#111;
  color:#fff;
  padding:8px 14px;
  border-radius:999px;
  opacity:0;
  transition:.2s;
}
.toast.show{opacity:1;}

/* ========= MOBILE ========= */
@media (max-width:1000px){
  #map-screen{
    grid-template-columns:1fr;
    grid-template-rows:auto 1fr auto;
  }

  .rail{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    height:64px;
    width:100%;
    flex-direction:row;
    justify-content:space-around;
    border-radius:16px 16px 0 0;
  }
  .rail:hover{width:100%;}
  .label{display:none!important;}

  #map{
    height:calc(50 * var(--app-vh));
    margin-bottom:10px;
  }
  .panel{
    height:auto;
    padding-bottom:calc(88px + env(safe-area-inset-bottom));
  }
}

/* ========= SAFETY ========= */
.screen:not(.active){display:none!important;}
